---

## Section 6: Querying with Peewee

Now that you've inserted data into your database, you'll often want to retrieve
it - whether to display it to the user, use it in calculations, or modify it.
Peewee provides a flexible and readable syntax for querying.

### Retrieving All Rows

To get all rows from a table, use the `.select()` method:

```python
for plane in Airplane.select():
    print(plane.name, plane.range_km)
```

This is equivalent to `SELECT * FROM airplane` in SQL, but allows you to use it
directly within something like a for loop.

### Filtering with `where()`

To narrow your query, use the `.where()` clause and comparison operators:

```python
long_range = Airplane.select().where(Airplane.range_km > 5000)
for plane in long_range:
    print(plane.name)
```

You can combine multiple conditions using `&` (and) and `|` (or):

```python
military = Airplane.select().where(
    (Airplane.jet_engine == True) & (Airplane.range_km > 1000)
)
```

### Ordering Results

Use `.order_by()` to sort results:

```python
# Sort by longest range first
planes = Airplane.select().order_by(-Airplane.range_km)
```

Use a minus sign (`-`) before the field to indicate descending order.

### Counting Rows

You can count rows using `.count()`:

```python
num_planes = Airplane.select().count()
print("Total airplanes:", num_planes)
```

### Projections (Selecting Specific Fields)

Sometimes you don’t need the full row - just certain fields. You can specify
them in `.select()`:

```python
query = Airplane.select(Airplane.name, Airplane.range_km)
for plane in query:
    print(f"{plane.name} has a range of {plane.range_km} km")
```

This improves performance when working with large tables and is a simple
optimization that can yield better performance.

### Aggregations (e.g., Min, Max, Average)

Peewee supports basic SQL aggregates via functions from `peewee.fn`:

```python
from peewee import fn

max_range = Airplane.select(fn.MAX(Airplane.range_km)).scalar()
print("Max airplane range:", max_range)
```

Other aggregate functions include `fn.COUNT()`, `fn.SUM()`, `fn.AVG()`.

### Predicates (Conditions for Filtering)

In Peewee, the `.where()` clause uses **predicates** — Boolean expressions
built with comparison operators like:

* `==`, `!=`, `<`, `>`, `<=`, `>=`
* `.contains()`, `.startswith()`, `.is_null()`, `.between()`

Example:

```python
# Find planes whose name starts with "F-"
fighters = Airplane.select().where(Airplane.name.startswith("F-"))
```

In the next section, we’ll explore **model relationships** using
`ForeignKeyField` to link rows across tables (e.g., planes assigned to pilots).

